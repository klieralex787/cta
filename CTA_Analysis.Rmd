---
title: "CTA Tweets"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(rtweet)
library(tidyr)
library(lubridate)
```

## The goal of this analysis is to understand delays in trains based on tweets from the CTA Twitter handle 

```{r pull_in_tweets, cache = TRUE}
# pull in 3200 recent tweets from CTA handle
cta_data <- get_timeline(
  "cta",
  n = 3200
)
```

We will be looking at around 2 months of CTA Twitter data (Twitter API only allows 3200 tweets to be pulled at a time) to determine the delays that occurred during the following time period:

```{r dates, echo = FALSE}
# minimum date 
print(paste("Start date:", min(date(cta_data$created_at))))

# maximum date
print(paste("End Date:", max(date(cta_data$created_at))))
```

# Exploratory Data Analysis
##Before pulling out only tweets that contain delay information, it is useful to ask some initial EDA questions

1. How many daily tweets occur in the initial dataset prior to any filtering?
```{r tot_vol, echo = FALSE}
volumes <- cta_data %>%
  mutate(day = day(created_at),
         month = month(created_at),
         dm = paste(month, day),
         wk_day = wday(created_at)) %>%
  group_by(dm) %>%
  summarise(volume = n())

print(summary(volumes$volume))
```

  We see an average of 57 daily tweets, with a range of 7 to 112. 

2. Is there variation among days of the week for tweet volumes?

```{r wkday_vol, echo = FALSE}
wk_day <- cta_data %>%
  mutate(wk_day = wday(created_at, label = TRUE))

ggplot(data = wk_day) + 
  geom_bar(aes(x = wk_day))
```

As expected, tweet volumes are higher during the work week, when there are likely more trains and passengers, and also likely more delays.

3. 
